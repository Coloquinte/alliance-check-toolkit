README_timing.rst
=================

Update October 24, 2022
------------------------

coriolis-2.x/src/alliance-check-toolkit/benchs/inverter/sky130_c4m/README_timing.rst

Goa
--------
This directory contains the files to analyze the timing response of:
  * a single inverter, (C4M.Sky130 FlexLib) 
  * a chain of 5 inverters (C4M.Sky130 FlexLib)

using either:

  * static timing analysis (STA), or
  * transistor level simulation, for comparison and estimation of STA accuracy.

using Free Open Source Software:

  * hitas for STA, and
  * ngspice for transistor level simulation.

Transitor model is BSIM4, using SkyWater 130 open PDK in:
/users/soft/analogdesign/scalable/techno/sky130_models_20220217/C4M.Sky130_all_lib.spice logic_tt

Selected transitor model for hitas or ngspice is :
/users/cao/mariem/coriolis-2.x/src/alliance-check-toolkit/benchs/inverter/sky130_c4m/techno/C4M_LIP6_Sky130_hitas.spice

Environment configuration for hitas
--------------------------------------
Launch:
  bash
  source ./hitas/avt_env.sh

Invertor timing analysis
-------------------------

A. With STA
++++++++++++
Running:

1. Building the timing database
   ./hitas/db_ng.tcl

NB. here, Hitas uses inv_x2_hitas.spi description of the netlist 
to detect VDD and VSS
(see inv_x2.rep)

2. Report critical paths
   ./hitas/report_inv_ng.tcl

provides the inv_x2.paths file that shows the 2 paths of the invertor.

+-------+--------+--------------+-----------------------+
| input | output | input slope  |  propagation delay
+=======+========+==============+=======================+
| F     | R      | 8            |  10
+-------+--------+--------------+-----------------------+
| R     | F      | 8            |  8 
+-------+--------+--------------+-----------------------+

where F: falling, R: rising, timing results in ps.

B. With transistor level simulator ngspice
++++++++++++++++++++++++++++++++++++++++++

ngpsice top_inv_x2.spi
displays timing plots with information of input slope and propagation delay :

+-------+--------+--------------+-----------------------+
| input | output | input slope  |  propagation delay
+=======+========+==============+=======================+
| F     | R      | 8            |  7.15
+-------+--------+--------------+-----------------------+
| R     | F      | 8            |  6.95
+-------+--------+--------------+-----------------------+

where F: falling, R: rising, timing results in ps.
showing that STA delays are greater than transistor simulation delays,  
keeping the relative order,
with an error for STA of : 28% in the worse case.

Invertor chain timing analysis
------------------------------

A. With STA
++++++++++++
Running:

1. Building the timing database
   ./hitas/db_chain_ng.tcl

NB. Here, Hitas uses inv_x2_chain_hitas.spi description of the netlist 
to detect VDD and VSS
(see inv_x2_chain.rep)

2. Report critical paths
   ./hitas/report_chain_ng.tcl

provides the inv_x2_chain.paths file that shows the 2 paths of the invertor chain.

+-------+--------+--------------+-----------------------+
| input | output | input slope  |  propagation delay
+=======+========+==============+=======================+
| F     | R      | 8            |  93
+-------+--------+--------------+-----------------------+
| R     | F      | 8            |  89
+-------+--------+--------------+-----------------------+

where F: falling, R: rising, timing results in ps.

3. Other analysis with the Hitas GUI: Xtas
   xtas
   file/open inv_x2_chain.dtx
   Tools/Get Paths
   Select path/path Detail

B. With transistor level simulator ngspice
++++++++++++++++++++++++++++++++++++++++++

ngpsice top_inv_x2_chain.spi
displays timing plots with information of input slope and propagation delay :

+-------+--------+--------------+-----------------------+
| input | output | input slope  |  propagation delay
+=======+========+==============+=======================+
| F     | R      | 8            |  87
+-------+--------+--------------+-----------------------+
| R     | F      | 8            |  85
+-------+--------+--------------+-----------------------+

showing that STA delays are greater than simulation delays, 
keeping the relative order, 
with an error for STA of : 6% in the worse case.

Clean
-----

./hitas/clean removes the timing files, except .paths files
./ngspice/clean_ngspice removes the files generated by the simulation
